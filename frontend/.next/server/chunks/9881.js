"use strict";exports.id=9881,exports.ids=[9881],exports.modules={76214:(e,s)=>{s.Z=function(e){return{id:"credentials",name:"Credentials",type:"credentials",credentials:{},authorize:()=>null,options:e}}},79881:(e,s,a)=>{a.a(e,async(e,r)=>{try{a.d(s,{authOptions:()=>l});var t=a(76214),n=a(33477),o=a(96309),i=e([o]);o=(i.then?(await i)():i)[0];let l={providers:[(0,t.Z)({name:"Credentials",credentials:{username:{label:"Username",type:"text"},password:{label:"Password",type:"password"}},async authorize(e){await (0,n.Z)();let s=await o.Z.findOne({username:e.username}).select("+password");if(!s)throw Error("No user found with that username.");if(!await s.matchPassword(e.password))throw Error("Invalid password.");return{id:s._id,name:s.username,role:s.role}}})],callbacks:{jwt:async({token:e,user:s})=>(s&&(e.role=s.role),e),session:async({session:e,token:s})=>(s&&(e.user.role=s.role),e)},pages:{signIn:"/admin/login"},session:{strategy:"jwt"},secret:process.env.NEXTAUTH_SECRET};r()}catch(e){r(e)}})},33477:(e,s,a)=>{a.d(s,{Z:()=>o});var r=a(11185),t=a.n(r);let n=global.mongoose;n||(n=global.mongoose={conn:null,promise:null});let o=async function(){let e=process.env.MONGODB_URI;if(!e)throw Error("Please define the MONGODB_URI environment variable inside .env.local");return n.conn||(n.promise||(n.promise=t().connect(e,{bufferCommands:!1}).then(e=>e)),n.conn=await n.promise),n.conn}},96309:(e,s,a)=>{a.a(e,async(e,r)=>{try{a.d(s,{Z:()=>d});var t=a(11185),n=a.n(t),o=a(27618),i=e([o]);o=(i.then?(await i)():i)[0];let l=new(n()).Schema({username:{type:String,required:[!0,"Please provide a username."],unique:!0},password:{type:String,required:[!0,"Please provide a password."],select:!1},role:{type:String,enum:["admin"],default:"admin"}},{timestamps:!0});l.pre("save",async function(e){this.isModified("password")||e();let s=await o.default.genSalt(10);this.password=await o.default.hash(this.password,s)}),l.methods.matchPassword=async function(e){return await o.default.compare(e,this.password)};let d=n().models.User||n().model("User",l);r()}catch(e){r(e)}})}};